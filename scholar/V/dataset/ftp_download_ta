from ftplib import FTP
import tarfile
import os

url = "ftp.ncbi.nlm.nih.gov"
file_path = "/pub/pmc/oa_package/8e/71/PMC5334499.tar.gz"
save_path = r"C:\Users\HP\Desktop\b1\PMC5334499.tar.gz"
extract_path = r"C:\Users\HP\Desktop\b1"

try:
    # Connect to the FTP server
    ftp = FTP(url)
    ftp.login()

    # Download the .tar.gz file
    with open(save_path, 'wb') as tar_file:
        ftp.retrbinary(f"RETR {file_path}", tar_file.write)

    print(f"File downloaded successfully and saved to {save_path}")

    # Extract the contents of the .tar.gz file
    with tarfile.open(save_path, 'r:gz') as tar:
        tar.extractall(extract_path)

    print(f"File extracted successfully to {extract_path}")

except Exception as e:
    print(f"Error: {e}")

finally:
    # Close the FTP connection
    ftp.quit()
