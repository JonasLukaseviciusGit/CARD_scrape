import json

file_path = r"C:\Users\HP\Desktop\CARD\google_scholar\pain_management.json"

def modify_urls(json_data):
    modified_urls = []

    for page_data in json_data:
        urls = page_data.get("urls", [])
        for url in urls:
            # Check if 'https://' is present in the URL before splitting
            if 'https://' in url:
                # Remove 'https://' and everything after the next '/'
                modified_url = url.split('https://')[1].split('/')[0]
                modified_urls.append(modified_url)
            else:
                # If 'https://' is not present, use the entire URL
                modified_urls.append(url)

    return modified_urls

def rank_and_count(modified_urls):
    url_count = {}

    for url in modified_urls:
        if url in url_count:
            url_count[url] += 1
        else:
            url_count[url] = 1

    ranked_urls = sorted(url_count.items(), key=lambda x: x[1], reverse=True)

    return ranked_urls

try:
    with open(file_path, 'r') as file:
        # Read lines one by one and parse each as JSON
        data = [json.loads(line) for line in file]

    modified_urls = modify_urls(data)
    ranked_urls = rank_and_count(modified_urls)

    print(ranked_urls)

except FileNotFoundError:
    print(f"File not found at path: {file_path}")
except json.JSONDecodeError as e:
    print(f"Error decoding JSON file at path: {file_path}")
    print(f"Exception details: {e}")
except Exception as e:
    print(f"An error occurred: {e}")
