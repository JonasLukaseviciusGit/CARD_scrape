import json
from tqdm import tqdm

def build_tree(data, tree):
    if not data:
        return

    char, rest = data[0], data[1:]
    if char not in tree:
        tree[char] = {}
    build_tree(rest, tree[char])

def process_entry(entry, tree):
    filename, _id = entry
    build_tree(_id, tree)

def process_json(json_file):
    with open(json_file, 'r') as f:
        data = json.load(f)

    tree = {}
    for entry in tqdm(data, desc="Building Tree"):
        process_entry(entry, tree)

    return tree

def save_tree_to_json(tree, output_file):
    with open(output_file, 'w') as f:
        json.dump(tree, f, indent=4)

if __name__ == "__main__":
    input_file = r"C:\Users\HP\Desktop\datasets-cleaned\_crude\comments\_indexing.json"
    output_file = r"C:\Users\HP\Desktop\datasets-cleaned\_crude\comments\_indexing-turbo.json"

    result_tree = process_json(input_file)
    save_tree_to_json(result_tree, output_file)

    print(f"Tree saved to {output_file}")
